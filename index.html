<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>برنامج أفق - متابعة تطور الطلاب</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c5aa0;
            --secondary-color: #4caf50;
            --accent-color: #ff9800;
            --light-color: #f5f9ff;
            --dark-color: #333;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f4f8;
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary-color), #1e3a6f);
            color: white;
            padding: 15px 0;
            box-shadow: var(--shadow);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .rc-logo {
            height: 60px;
            width: auto;
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        .initiative-creator {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            flex-wrap: wrap;
        }
        
        nav ul li {
            margin-left: 20px;
        }
        
        nav ul li a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        nav ul li a:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .section {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        .section-title {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .card {
            background: var(--light-color);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-title {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9rem;
        }
        
        table th, table td {
            padding: 12px 10px;
            text-align: right;
            border-bottom: 1px solid #ddd;
        }
        
        table th {
            background-color: var(--primary-color);
            color: white;
            position: sticky;
            top: 0;
        }
        
        table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        table tr:hover {
            background-color: #f1f1f1;
        }
        
        .improvement-good {
            color: var(--secondary-color);
            font-weight: bold;
        }
        
        .improvement-medium {
            color: var(--accent-color);
            font-weight: bold;
        }
        
        .improvement-low {
            color: #f44336;
            font-weight: bold;
        }
        
        .btn {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            transition: background 0.3s;
            margin: 3px;
            font-size: 0.85rem;
        }
        
        .btn:hover {
            background: #1e3a6f;
        }
        
        .btn-secondary {
            background: var(--secondary-color);
        }
        
        .btn-secondary:hover {
            background: #3d8b40;
        }
        
        .btn-accent {
            background: var(--accent-color);
        }
        
        .btn-accent:hover {
            background: #e68900;
        }
        
        .btn-print {
            background: #6c757d;
        }
        
        .btn-print:hover {
            background: #5a6268;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .program-info {
            background: linear-gradient(135deg, var(--light-color), #e6efff);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .creator-badge {
            background: linear-gradient(135deg, #ff9800, #f57c00);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            margin-top: 10px;
        }
        
        footer {
            background: var(--dark-color);
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
        }
        
        .table-container {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .example-project {
            border: 2px dashed var(--primary-color);
            background: #f8fbff;
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .project-preview {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            box-shadow: var(--shadow);
        }
        
        .project-screenshot {
            width: 100%;
            max-width: 800px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            margin: 15px 0;
            border: 1px solid #ddd;
        }
        
        .project-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        .treatment-plan {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: var(--shadow);
        }
        
        .treatment-header {
            background: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 8px 8px 0 0;
            margin: -20px -20px 20px -20px;
        }
        
        .treatment-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }
        
        .treatment-section:last-child {
            border-bottom: none;
        }
        
        .plan-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .student-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .plan-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
        }
        
        @media print {
            header, footer, nav, .btn, .section-title .btn {
                display: none !important;
            }
            
            .section {
                box-shadow: none;
                border: 1px solid #ddd;
            }
            
            .treatment-plan {
                break-inside: avoid;
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .logo-section {
                justify-content: center;
                margin-bottom: 15px;
            }
            
            nav ul {
                margin-top: 15px;
                justify-content: center;
            }
            
            nav ul li {
                margin: 0 10px;
            }
            
            .grid, .plan-grid {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                flex-direction: column;
                align-items: flex-start;
            }
            
            table {
                font-size: 0.8rem;
            }
            
            table th, table td {
                padding: 8px 5px;
            }
            
            .project-links {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <!-- شعار الهيئة الملكية -->
                    <div class="rc-logo">
                        <svg width="180" height="60" viewBox="0 0 180 60" xmlns="http://www.w3.org/2000/svg">
                            <rect width="180" height="60" fill="#1e3a6f" rx="5"/>
                            <text x="90" y="35" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="14" font-weight="bold">
                                الهيئة الملكية للجبيل وينبع
                            </text>
                            <text x="90" y="50" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10">
                                Royal Commission for Jubail & Yanbu
                            </text>
                        </svg>
                    </div>
                    <div class="logo-text">
                        <div class="logo">برنامج أفق - متابعة التطور الدراسي</div>
                        <div class="initiative-creator">صاحب المبادرة: عبدالله محمد حمدي</div>
                    </div>
                </div>
                <nav>
                    <ul>
                        <li><a href="#overview">نظرة عامة</a></li>
                        <li><a href="#students">الطلاب</a></li>
                        <li><a href="#comparison">المقارنات</a></li>
                        <li><a href="#project-example">مشاريع الطلاب</a></li>
                        <li><a href="#treatment-plans">الخطط العلاجية</a></li>
                        <li><a href="#reports">التقارير</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <section id="overview" class="section">
            <h2 class="section-title">
                نظرة عامة على البرنامج
                <div class="creator-badge">مبادرة: عبدالله محمد حمدي</div>
            </h2>
            <div class="program-info">
                <h3>برنامج "أفق" لرفع التحصيل الدراسي</h3>
                <p>برنامج تعليمي يهدف إلى رفع التحصيل الدراسي وتنمية المهارات التعاونية والرقمية لطلاب الصف الأول الثانوي في مادة الكيمياء.</p>
                <p>يعتمد البرنامج على تحويل الطلاب من متلقين سلبيين إلى منتجين للمعرفة من خلال العمل التعاوني وإعداد بنك أسئلة تفاعلي.</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">38</div>
                    <div class="stat-label">عدد الطلاب</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">18.5%</div>
                    <div class="stat-label">متوسط التحسن</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">84%</div>
                    <div class="stat-label">نسبة الطلاب المحسنين</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">6</div>
                    <div class="stat-label">عدد المجموعات التعاونية</div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="overviewChart"></canvas>
            </div>
        </section>

        <section id="students" class="section">
            <h2 class="section-title">بيانات الطلاب والدرجات</h2>
            <div class="form-group">
                <button class="btn" id="addStudentBtn">إضافة طالب جديد</button>
                <button class="btn btn-secondary" id="importDataBtn">استيراد البيانات</button>
            </div>
            
            <div class="table-container">
                <table id="studentsTable">
                    <thead>
                        <tr>
                            <th>م</th>
                            <th>اسم الطالب</th>
                            <th>الواجبات (قبل)</th>
                            <th>التفاعل الصفي (قبل)</th>
                            <th>بليكرز (قبل)</th>
                            <th>الاختبار (قبل)</th>
                            <th>الواجبات (بعد)</th>
                            <th>التفاعل الصفي (بعد)</th>
                            <th>بليكرز (بعد)</th>
                            <th>الاختبار (بعد)</th>
                            <th>التحسن الإجمالي</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="studentsTableBody">
                        <!-- سيتم ملؤها بالبيانات -->
                    </tbody>
                </table>
            </div>
        </section>

        <section id="comparison" class="section">
            <h2 class="section-title">مقارنة الأداء قبل وبعد البرنامج</h2>
            
            <div class="grid">
                <div class="card">
                    <h3 class="card-title">توزيع التحسن</h3>
                    <div class="chart-container">
                        <canvas id="improvementChart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">مقارنة حسب الفئات</h3>
                    <div class="chart-container">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <canvas id="comparisonChart"></canvas>
            </div>
        </section>

        <section id="project-example" class="section">
            <h2 class="section-title">مشاريع الطلاب: بنوك الأسئلة التفاعلية</h2>
            
            <div class="example-project">
                <h3>بنوك الأسئلة التفاعلية في الكيمياء</h3>
                <p>هذه المشاريع هي نتاج تطبيق برنامج "أفق" حيث قام الطلاب بتصميم وإعداد بنوك أسئلة تفاعلية في مادة الكيمياء باستخدام تقنيات الويب.</p>
                
                <div class="project-preview">
                    <h4>مشروع الطالب الأول: بنك أسئلة تفاعلي شامل</h4>
                    <p>بنك أسئلة شامل يغطي مختلف وحدات منهج الكيمياء للصف الأول الثانوي، مع تصميم تفاعلي جذاب.</p>
                    
                    <div class="project-links">
                        <a href="https://m7md-09.github.io/-/" target="_blank" class="btn btn-accent">
                            <i class="fas fa-external-link-alt"></i> تجربة المشروع الأول
                        </a>
                    </div>
                </div>
                
                <div class="project-preview">
                    <h4>مشروع الطالب الثاني: تطبيق اختبارات تفاعلي</h4>
                    <p>تطبيق متقدم يحتوي على اختبارات تفاعلية مع تصحيح فوري وتقارير أداء.</p>
                    
                    <div class="project-links">
                        <a href="https://rrivv3216.github.io/-4/" target="_blank" class="btn btn-accent">
                            <i class="fas fa-external-link-alt"></i> تجربة المشروع الثاني
                        </a>
                    </div>
                </div>
                
                <div class="project-preview">
                    <h4>كيف ساهمت هذه المشاريع في رفع التحصيل الدراسي؟</h4>
                    <ul>
                        <li>تعميق فهم الطلاب للمفاهيم الكيميائية من خلال صياغة الأسئلة</li>
                        <li>تنمية مهارات العمل الجماعي والتعاون بين الطلاب</li>
                        <li>تحسين المهارات الرقمية والتقنية لدى الطلاب</li>
                        <li>زيادة دافعية الطلاب للتعلم والمشاركة</li>
                        <li>توفير موارد تعليمية تفاعلية يمكن للجميع الاستفادة منها</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="treatment-plans" class="section">
            <h2 class="section-title">الخطط العلاجية للطلاب</h2>
            
            <div class="student-selector">
                <select id="studentSelect" class="form-control">
                    <option value="">اختر طالباً لعرض خطته العلاجية</option>
                    <!-- سيتم ملؤها بالطلاب -->
                </select>
                <button class="btn" id="generatePlan">إنشاء خطة علاجية</button>
                <button class="btn btn-print" onclick="window.print()"><i class="fas fa-print"></i> طباعة الخطط</button>
            </div>
            
            <div class="plan-grid" id="plansContainer">
                <!-- سيتم إضافة الخطط العلاجية هنا -->
            </div>
            
            <div class="treatment-plan">
                <div class="treatment-header">
                    <h3>الخطة العلاجية الجماعية</h3>
                </div>
                
                <div class="treatment-section">
                    <h4>أولاً: الطلاب ذوو التحسن المحدود (أقل من 10%)</h4>
                    <p><strong>الاستراتيجيات المقترحة:</strong></p>
                    <ul>
                        <li>جلسات علاجية أسبوعية مكثفة تركز على المفاهيم الأساسية</li>
                        <li>توفير موارد إضافية ومراجعات مصغرة للمواضيع الصعبة</li>
                        <li>تعزيز مهارات التعلم الذاتي وتنظيم الوقت</li>
                        <li>متابعة فردية أسبوعية من المعلم لتقييم التقدم</li>
                    </ul>
                </div>
                
                <div class="treatment-section">
                    <h4>ثانياً: الطلاب ذوو التحسن المتوسط (10% - 20%)</h4>
                    <p><strong>الاستراتيجيات المقترحة:</strong></p>
                    <ul>
                        <li>تشجيع العمل الجماعي مع أقران متفوقين</li>
                        <li>تطوير مهارات حل المسائل والتطبيقات العملية</li>
                        <li>تعزيز الثقة بالنفس من خلال تكليفهم بمهام قيادية في المجموعات</li>
                        <li>توفير تحديات إضافية لتحفيز التفكير النقدي</li>
                    </ul>
                </div>
                
                <div class="treatment-section">
                    <h4>ثالثاً: الطلاب ذوو التحسن الكبير (أكثر من 20%)</h4>
                    <p><strong>الاستراتيجيات المقترحة:</strong></p>
                    <ul>
                        <li>تكليفهم بدور المساعدين في المجموعات التعليمية</li>
                        <li>توفير مشاريع إثرائية تتحدى قدراتهم</li>
                        <li>تشجيعهم على المشاركة في مسابقات وأنشطة إبداعية</li>
                        <li>تطوير مهارات القيادة والتعليم الذاتي</li>
                    </ul>
                </div>
                
                <div class="plan-actions">
                    <button class="btn btn-secondary" onclick="downloadPlan('الخطة العلاجية الجماعية')">
                        <i class="fas fa-download"></i> تحميل الخطة
                    </button>
                    <button class="btn btn-print" onclick="window.print()">
                        <i class="fas fa-print"></i> طباعة الخطة
                    </button>
                </div>
            </div>
        </section>

        <section id="reports" class="section">
            <h2 class="section-title">التقارير والتحليلات</h2>
            
            <div class="grid">
                <div class="card">
                    <h3 class="card-title">تقرير الصف</h3>
                    <p>عرض شامل لأداء الصف ككل ومقارنة مع المعايير الوطنية.</p>
                    <button class="btn">عرض التقرير</button>
                </div>
                <div class="card">
                    <h3 class="card-title">تقرير فردي</h3>
                    <p>إنشاء تقارير مفصلة لكل طالب مع توصيات علاجية.</p>
                    <button class="btn">إنشاء التقارير</button>
                </div>
                <div class="card">
                    <h3 class="card-title">تحليل النتائج</h3>
                    <p>تحليل إحصائي متقدم للنتائج وتأثير البرنامج.</p>
                    <button class="btn">عرض التحليل</button>
                </div>
            </div>
            
            <div class="form-group">
                <button class="btn" id="exportPdfBtn">تصدير إلى PDF</button>
                <button class="btn btn-secondary" id="exportExcelBtn">تصدير إلى Excel</button>
            </div>
        </section>
    </div>

    <footer>
        <div class="container">
            <p>برنامج أفق - متابعة تطور الطلاب &copy; 2023</p>
            <p>ثانوية العلا - الهيئة الملكية بالجبيل</p>
            <p>صاحب المبادرة: عبدالله محمد حمدي</p>
        </div>
    </footer>

    <script>
        // بيانات الطلاب الكاملة من ملف Excel
        const studentsData = [
            { id: 1, name: "أسامة بن ابراھيم بن سعد الدوسري", preHomework: 8.75, preInteraction: 8, prePlickers: 6, preExam: 8, postHomework: 10, postInteraction: 10, postPlickers: 8, postExam: 12 },
            { id: 2, name: "الباسل بن فھد بن جسام الشمري", preHomework: 3.75, preInteraction: 8, prePlickers: 8, preExam: 6.5, postHomework: 6, postInteraction: 10, postPlickers: 10, postExam: 11 },
            { id: 3, name: "الوليد بن خالد بن سويلم الرويضي الرشيدي", preHomework: 5, preInteraction: 2, prePlickers: 9, preExam: 3, postHomework: 7, postInteraction: 6, postPlickers: 10, postExam: 7 },
            { id: 4, name: "باسل بن يحيى بن علي الزھراني", preHomework: 3.75, preInteraction: 2, prePlickers: 7, preExam: 10.5, postHomework: 6, postInteraction: 6, postPlickers: 9, postExam: 15 },
            { id: 5, name: "برزان بن نايف بن دعسان الشمري", preHomework: 1.25, preInteraction: 2, prePlickers: 8, preExam: 4.5, postHomework: 5, postInteraction: 6, postPlickers: 10, postExam: 9 },
            { id: 6, name: "تركي بن محمد بن عوض ال جميح", preHomework: 8.75, preInteraction: 7, prePlickers: 9, preExam: 11, postHomework: 10, postInteraction: 9, postPlickers: 10, postExam: 15 },
            { id: 7, name: "حمد بن سعد بن عبد' الخالدي", preHomework: 7.5, preInteraction: 2, prePlickers: 5, preExam: 7.5, postHomework: 9, postInteraction: 6, postPlickers: 7, postExam: 11 },
            { id: 8, name: "خالد بن وليد بن محمد الزھراني", preHomework: 10, preInteraction: 3, prePlickers: 8, preExam: 6, postHomework: 10, postInteraction: 6, postPlickers: 10, postExam: 10 },
            { id: 9, name: "ريان بن جھز بن نواف البيضاني الحربي", preHomework: 10, preInteraction: 3, prePlickers: 7, preExam: 5.5, postHomework: 10, postInteraction: 6, postPlickers: 9, postExam: 10 },
            { id: 10, name: "ريان بن ناصر بن شويل ا(حمري", preHomework: 8.75, preInteraction: 3, prePlickers: 9, preExam: 10.5, postHomework: 10, postInteraction: 6, postPlickers: 10, postExam: 14 },
            { id: 11, name: "سليمان بن عبد' بن علي اليامي", preHomework: 7.5, preInteraction: 3, prePlickers: 8, preExam: 7, postHomework: 9, postInteraction: 6, postPlickers: 10, postExam: 11 },
            { id: 12, name: "صالح بن احمد بن صالح المزيد", preHomework: 10, preInteraction: 5, prePlickers: 8, preExam: 10, postHomework: 10, postInteraction: 8, postPlickers: 10, postExam: 14 },
            { id: 13, name: "ضاري بن صالح بن معزي العباس", preHomework: 6.25, preInteraction: 10, prePlickers: 10, preExam: 12, postHomework: 10, postInteraction: 10, postPlickers: 10, postExam: 15 },
            { id: 14, name: "ضاوي بن خالد بن صالح الخالدي", preHomework: 10, preInteraction: 2, prePlickers: 4, preExam: 5, postHomework: 10, postInteraction: 6, postPlickers: 6, postExam: 9 },
            { id: 15, name: "طلال بن حمد بن محمد القرفي الھاجري", preHomework: 2.5, preInteraction: 2, prePlickers: 10, preExam: 7.5, postHomework: 5, postInteraction: 6, postPlickers: 10, postExam: 11 },
            { id: 16, name: "طلال بن نايف بن فلاح رويضي الرشيدي", preHomework: 7.5, preInteraction: 2, prePlickers: 6, preExam: 5, postHomework: 10, postInteraction: 6, postPlickers: 8, postExam: 9 },
            { id: 17, name: "عبدالرحمن بن مبارك بن خالد المستحي", preHomework: 5, preInteraction: 8, prePlickers: 9, preExam: 7.5, postHomework: 7, postInteraction: 10, postPlickers: 10, postExam: 12 },
            { id: 18, name: "عبدالعزيز بن جابر بن حمد المرى", preHomework: 3.75, preInteraction: 5, prePlickers: 8, preExam: 7.5, postHomework: 6, postInteraction: 7, postPlickers: 10, postExam: 12 },
            { id: 19, name: "عبدالعزيز بن علي بن عبد' العماري", preHomework: 10, preInteraction: 3, prePlickers: 9, preExam: 2, postHomework: 10, postInteraction: 6, postPlickers: 10, postExam: 6 },
            { id: 20, name: "عبدالعزيز بن مقبل بن نقاء السالمي الحربي", preHomework: 7.5, preInteraction: 8, prePlickers: 8, preExam: 7.5, postHomework: 9, postInteraction: 10, postPlickers: 10, postExam: 11 },
            { id: 21, name: "عبدالعزيز بن ھايل بن عويضه العنزي", preHomework: 8.75, preInteraction: 3, prePlickers: 10, preExam: 9, postHomework: 10, postInteraction: 6, postPlickers: 10, postExam: 13 },
            { id: 22, name: "عصام بن احمد بن عصام مكي", preHomework: 6.25, preInteraction: 3, prePlickers: 7, preExam: 5.5, postHomework: 9, postInteraction: 6, postPlickers: 9, postExam: 9 },
            { id: 23, name: "علي بن عبد' بن علي الحارثي", preHomework: 6.25, preInteraction: 8, prePlickers: 10, preExam: 10, postHomework: 9, postInteraction: 10, postPlickers: 10, postExam: 14 },
            { id: 24, name: "علي بن عبدالمجيد بن علي الشھري", preHomework: 2.5, preInteraction: 5, prePlickers: 9, preExam: 9, postHomework: 5, postInteraction: 8, postPlickers: 10, postExam: 13 },
            { id: 25, name: "فارس بن ھشام بن أحمد حكمي", preHomework: 8.75, preInteraction: 4, prePlickers: 8, preExam: 7.5, postHomework: 10, postInteraction: 7, postPlickers: 10, postExam: 11 },
            { id: 26, name: "فھد بن محمد بن فھد القحطاني", preHomework: 10, preInteraction: 4, prePlickers: 7, preExam: 6, postHomework: 10, postInteraction: 7, postPlickers: 9, postExam: 10 },
            { id: 27, name: "ماجد بن سالم بن عبد' الحقباني الدوسري", preHomework: 6.25, preInteraction: 3, prePlickers: 5, preExam: 3, postHomework: 9, postInteraction: 6, postPlickers: 7, postExam: 7 },
            { id: 28, name: "مثنى بن عبدالرحمن بن عياد الشمري", preHomework: 8.75, preInteraction: 4, prePlickers: 8, preExam: 9, postHomework: 10, postInteraction: 7, postPlickers: 10, postExam: 13 },
            { id: 29, name: "محمد بن اسماعيل بن سالم القحطاني", preHomework: 3.75, preInteraction: 5, prePlickers: 9, preExam: 10, postHomework: 6, postInteraction: 8, postPlickers: 10, postExam: 14 },
            { id: 30, name: "محمد بن حزام بن عبود العجمي", preHomework: 6.25, preInteraction: 5, prePlickers: 6, preExam: 4, postHomework: 8, postInteraction: 8, postPlickers: 8, postExam: 8 },
            { id: 31, name: "محمد بن فھد بن محمد القحطاني", preHomework: 1.25, preInteraction: 10, prePlickers: 9, preExam: 7, postHomework: 5, postInteraction: 10, postPlickers: 10, postExam: 11 },
            { id: 32, name: "مسلم بن ابراھيم بن مسلم الرويشد", preHomework: 8.75, preInteraction: 7, prePlickers: 10, preExam: 5.5, postHomework: 10, postInteraction: 10, postPlickers: 10, postExam: 10 },
            { id: 33, name: "مشعل بن فراج بن لوفان الشمري", preHomework: 5, preInteraction: 5, prePlickers: 4, preExam: 2, postHomework: 7, postInteraction: 7, postPlickers: 6, postExam: 6 },
            { id: 34, name: "منيف بن خالد بن منيف الشھراني", preHomework: 3.75, preInteraction: 5, prePlickers: 5, preExam: 4.5, postHomework: 6, postInteraction: 7, postPlickers: 7, postExam: 9 },
            { id: 35, name: "ناصر بن متعب بن ناصر العتيبي", preHomework: 5, preInteraction: 4, prePlickers: 9, preExam: 11.5, postHomework: 7, postInteraction: 7, postPlickers: 10, postExam: 14 },
            { id: 36, name: "ھتان بن طارق بن رافع آل رافع الغامدي", preHomework: 6.25, preInteraction: 5, prePlickers: 9, preExam: 7.5, postHomework: 8, postInteraction: 8, postPlickers: 10, postExam: 11 },
            { id: 37, name: "ياسر بن ماجد بن مسفر الغامدي", preHomework: 6.25, preInteraction: 7, prePlickers: 10, preExam: 7, postHomework: 8, postInteraction: 9, postPlickers: 10, postExam: 11 }
        ];

        // حساب الدرجات الإجمالية والتحسن
        studentsData.forEach(student => {
            student.preTotal = student.preHomework + student.preInteraction + student.prePlickers + student.preExam;
            student.postTotal = student.postHomework + student.postInteraction + student.postPlickers + student.postExam;
            student.improvement = ((student.postTotal - student.preTotal) / student.preTotal * 100).toFixed(1);
        });

        // تصنيف الطلاب حسب مستوى التحسن
        function getImprovementCategory(improvement) {
            if (improvement >= 20) return { category: "تحسن كبير", class: "improvement-good", level: "high" };
            if (improvement >= 10) return { category: "تحسن متوسط", class: "improvement-medium", level: "medium" };
            if (improvement > 0) return { category: "تحسن محدود", class: "improvement-low", level: "low" };
            return { category: "لم يتحسن", class: "improvement-low", level: "none" };
        }

        // ملء جدول الطلاب
        function populateStudentsTable() {
            const tableBody = document.getElementById('studentsTableBody');
            tableBody.innerHTML = '';
            
            studentsData.forEach(student => {
                const improvementInfo = getImprovementCategory(parseFloat(student.improvement));
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${student.id}</td>
                    <td>${student.name}</td>
                    <td>${student.preHomework}</td>
                    <td>${student.preInteraction}</td>
                    <td>${student.prePlickers}</td>
                    <td>${student.preExam}</td>
                    <td>${student.postHomework}</td>
                    <td>${student.postInteraction}</td>
                    <td>${student.postPlickers}</td>
                    <td>${student.postExam}</td>
                    <td class="${improvementInfo.class}">${improvementInfo.category} (${student.improvement}%)</td>
                    <td>
                        <button class="btn" onclick="viewStudentDetails(${student.id})">عرض</button>
                        <button class="btn btn-secondary" onclick="generateTreatmentPlan(${student.id})">خطة علاجية</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // ملء قائمة اختيار الطلاب
        function populateStudentSelect() {
            const studentSelect = document.getElementById('studentSelect');
            studentSelect.innerHTML = '<option value="">اختر طالباً لعرض خطته العلاجية</option>';
            
            studentsData.forEach(student => {
                const improvementInfo = getImprovementCategory(parseFloat(student.improvement));
                const option = document.createElement('option');
                option.value = student.id;
                option.textContent = `${student.name} - ${improvementInfo.category}`;
                studentSelect.appendChild(option);
            });
        }

        // إنشاء الخطط العلاجية
        function generateTreatmentPlan(studentId) {
            const student = studentsData.find(s => s.id === studentId);
            if (!student) return;
            
            const improvementInfo = getImprovementCategory(parseFloat(student.improvement));
            const plansContainer = document.getElementById('plansContainer');
            
            // إزالة الخطة الحالية للطالب إذا كانت موجودة
            const existingPlan = document.getElementById(`plan-${studentId}`);
            if (existingPlan) {
                existingPlan.remove();
            }
            
            const plan = document.createElement('div');
            plan.className = 'treatment-plan';
            plan.id = `plan-${studentId}`;
            
            // تحديد الاستراتيجيات بناءً على مستوى التحسن
            let strategies = [];
            if (improvementInfo.level === 'high') {
                strategies = [
                    "تكليف الطالب بدور المساعد في المجموعات التعليمية",
                    "توفير مشاريع إثرائية تتحدى قدراته",
                    "تشجيعه على المشاركة في مسابقات وأنشطة إبداعية",
                    "تطوير مهارات القيادة والتعليم الذاتي"
                ];
            } else if (improvementInfo.level === 'medium') {
                strategies = [
                    "تشجيع العمل الجماعي مع أقران متفوقين",
                    "تطوير مهارات حل المسائل والتطبيقات العملية",
                    "تعزيز الثقة بالنفس من خلال تكليفه بمهام قيادية",
                    "توفير تحديات إضافية لتحفيز التفكير النقدي"
                ];
            } else {
                strategies = [
                    "جلسات علاجية أسبوعية مكثفة تركز على المفاهيم الأساسية",
                    "توفير موارد إضافية ومراجعات مصغرة للمواضيع الصعبة",
                    "تعزيز مهارات التعلم الذاتي وتنظيم الوقت",
                    "متابعة فردية أسبوعية من المعلم لتقييم التقدم"
                ];
            }
            
            plan.innerHTML = `
                <div class="treatment-header">
                    <h3>الخطة العلاجية للطالب: ${student.name}</h3>
                </div>
                
                <div class="treatment-section">
                    <h4>معلومات الطالب</h4>
                    <p><strong>الدرجة الإجمالية قبل البرنامج:</strong> ${student.preTotal}</p>
                    <p><strong>الدرجة الإجمالية بعد البرنامج:</strong> ${student.postTotal}</p>
                    <p><strong>نسبة التحسن:</strong> <span class="${improvementInfo.class}">${student.improvement}%</span></p>
                    <p><strong>التصنيف:</strong> ${improvementInfo.category}</p>
                </div>
                
                <div class="treatment-section">
                    <h4>الاستراتيجيات العلاجية المقترحة</h4>
                    <ul>
                        ${strategies.map(strategy => `<li>${strategy}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="treatment-section">
                    <h4>مؤشرات التقدم المتوقعة</h4>
                    <ul>
                        <li>تحسن في الدرجات بمعدل 5-10% خلال الشهر القادم</li>
                        <li>زيادة المشاركة الصفية والتفاعل مع الأنشطة</li>
                        <li>تحسن في مهارات حل المسائل والتطبيقات العملية</li>
                        <li>زيادة الثقة بالنفس والدافعية للتعلم</li>
                    </ul>
                </div>
                
                <div class="treatment-section">
                    <h4>متابعة وتقييم</h4>
                    <p><strong>مواعيد المتابعة:</strong> أسبوعياً كل يوم أحد</p>
                    <p><strong>مسؤول المتابعة:</strong> معلم المادة + المرشد الطلابي</p>
                    <p><strong>أدوات التقييم:</strong> اختبارات قصيرة - ملاحظة المشاركة - تقييم الأنشطة</p>
                </div>
                
                <div class="plan-actions">
                    <button class="btn btn-secondary" onclick="downloadPlan('${student.name}')">
                        <i class="fas fa-download"></i> تحميل الخطة
                    </button>
                    <button class="btn" onclick="editPlan(${studentId})">
                        <i class="fas fa-edit"></i> تعديل الخطة
                    </button>
                    <button class="btn btn-print" onclick="window.print()">
                        <i class="fas fa-print"></i> طباعة الخطة
                    </button>
                </div>
            `;
            
            plansContainer.appendChild(plan);
            plansContainer.scrollIntoView({ behavior: 'smooth' });
        }

        // وظائف مساعدة
        function downloadPlan(studentName) {
            alert(`جارٍ تحميل الخطة العلاجية للطالب: ${studentName}`);
            // في التطبيق الحقيقي، هنا سيتم إنشاء ملف PDF للخطة
        }

        function editPlan(studentId) {
            alert(`فتح نافذة تعديل الخطة للطالب رقم: ${studentId}`);
            // في التطبيق الحقيقي، هنا ستفتح نافذة لتعديل الخطة
        }

        function viewStudentDetails(studentId) {
            const student = studentsData.find(s => s.id === studentId);
            if (student) {
                const improvementInfo = getImprovementCategory(parseFloat(student.improvement));
                alert(`تفاصيل الطالب:\n\nالاسم: ${student.name}\n\nالدرجات قبل البرنامج:\n- الواجبات: ${student.preHomework}\n- التفاعل الصفي: ${student.preInteraction}\n- بليكرز: ${student.prePlickers}\n- الاختبار: ${student.preExam}\n- الإجمالي: ${student.preTotal}\n\nالدرجات بعد البرنامج:\n- الواجبات: ${student.postHomework}\n- التفاعل الصفي: ${student.postInteraction}\n- بليكرز: ${student.postPlickers}\n- الاختبار: ${student.postExam}\n- الإجمالي: ${student.postTotal}\n\nنسبة التحسن: ${student.improvement}%\nالتصنيف: ${improvementInfo.category}`);
            }
        }

        // إنشاء الرسوم البيانية
        function createCharts() {
            // رسم بياني للنظرة العامة
            const overviewCtx = document.getElementById('overviewChart').getContext('2d');
            new Chart(overviewCtx, {
                type: 'bar',
                data: {
                    labels: studentsData.map(s => s.name.split(' ')[0] + ' ' + s.name.split(' ')[1]),
                    datasets: [
                        {
                            label: 'الإجمالي قبل البرنامج',
                            data: studentsData.map(s => s.preTotal),
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'الإجمالي بعد البرنامج',
                            data: studentsData.map(s => s.postTotal),
                            backgroundColor: 'rgba(75, 192, 192, 0.7)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 50
                        }
                    }
                }
            });

            // رسم بياني للتحسن
            const improvementCtx = document.getElementById('improvementChart').getContext('2d');
            
            // تجميع الطلاب حسب فئة التحسن
            const categories = {
                "تحسن كبير": studentsData.filter(s => parseFloat(s.improvement) >= 20).length,
                "تحسن متوسط": studentsData.filter(s => parseFloat(s.improvement) >= 10 && parseFloat(s.improvement) < 20).length,
                "تحسن محدود": studentsData.filter(s => parseFloat(s.improvement) > 0 && parseFloat(s.improvement) < 10).length,
                "لم يتحسن": studentsData.filter(s => parseFloat(s.improvement) <= 0).length
            };
            
            new Chart(improvementCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(categories),
                    datasets: [{
                        data: Object.values(categories),
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(255, 152, 0, 0.7)',
                            'rgba(255, 193, 7, 0.7)',
                            'rgba(244, 67, 54, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            // رسم بياني للمقارنة
            const comparisonCtx = document.getElementById('comparisonChart').getContext('2d');
            new Chart(comparisonCtx, {
                type: 'line',
                data: {
                    labels: studentsData.map(s => s.name.split(' ')[0] + ' ' + s.name.split(' ')[1]),
                    datasets: [
                        {
                            label: 'الإجمالي قبل البرنامج',
                            data: studentsData.map(s => s.preTotal),
                            borderColor: 'rgba(54, 162, 235, 1)',
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            tension: 0.3,
                            fill: false
                        },
                        {
                            label: 'الإجمالي بعد البرنامج',
                            data: studentsData.map(s => s.postTotal),
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.1)',
                            tension: 0.3,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 50
                        }
                    }
                }
            });

            // رسم بياني للفئات
            const categoryCtx = document.getElementById('categoryChart').getContext('2d');
            new Chart(categoryCtx, {
                type: 'bar',
                data: {
                    labels: Object.keys(categories),
                    datasets: [{
                        label: 'عدد الطلاب',
                        data: Object.values(categories),
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(255, 152, 0, 0.7)',
                            'rgba(255, 193, 7, 0.7)',
                            'rgba(244, 67, 54, 0.7)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // تهيئة التطبيق
        document.addEventListener('DOMContentLoaded', function() {
            populateStudentsTable();
            populateStudentSelect();
            createCharts();
            
            // إضافة مستمعي الأحداث للأزرار
            document.getElementById('addStudentBtn').addEventListener('click', function() {
                alert('فتح نموذج إضافة طالب جديد');
            });
            
            document.getElementById('importDataBtn').addEventListener('click', function() {
                alert('فتح نافذة استيراد البيانات');
            });
            
            document.getElementById('generatePlan').addEventListener('click', function() {
                const studentSelect = document.getElementById('studentSelect');
                const selectedStudentId = parseInt(studentSelect.value);
                if (selectedStudentId) {
                    generateTreatmentPlan(selectedStudentId);
                } else {
                    alert('يرجى اختيار طالب أولاً');
                }
            });
            
            document.getElementById('exportPdfBtn').addEventListener('click', function() {
                alert('جاري تصدير التقرير إلى PDF');
            });
            
            document.getElementById('exportExcelBtn').addEventListener('click', function() {
                alert('جاري تصدير التقرير إلى Excel');
            });
        });
    </script>
</body>
</html>
